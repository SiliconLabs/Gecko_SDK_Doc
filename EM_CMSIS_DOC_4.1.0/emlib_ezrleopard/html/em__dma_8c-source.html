<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Silicon Labs EZR32 emlib Peripheral Library: release/EM_CMSIS_P1_4.1.0/emlib/src/em_dma.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_99634199317e4752b1934502e0d836c4.html">release</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_382a31a6d951115af2a1e7624d96c391.html">EM_CMSIS_P1_4.1.0</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_2bb29a122c859e975fa16e4cc28d11d7.html">emlib</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_f09ea23800c86a7e4fd7d642f3adf232.html">src</a></div>
<h1>em_dma.c</h1><a href="em__dma_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/***************************************************************************/</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include "<a class="code" href="em__dma_8h.html">em_dma.h</a>"</span>
<a name="l00034"></a>00034 <span class="preprocessor">#if defined( DMA_PRESENT )</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span>
<a name="l00036"></a>00036 <span class="preprocessor">#include "<a class="code" href="em__cmu_8h.html">em_cmu.h</a>"</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include "<a class="code" href="em__assert_8h.html">em_assert.h</a>"</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include "<a class="code" href="em__bus_8h.html">em_bus.h</a>"</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="comment">/***************************************************************************/</span>
<a name="l00045"></a>00045 <span class="comment">/***************************************************************************/</span>
<a name="l00124"></a>00124 <span class="comment">/*******************************************************************************</span>
<a name="l00125"></a>00125 <span class="comment"> **************************   LOCAL FUNCTIONS   ********************************</span>
<a name="l00126"></a>00126 <span class="comment"> ******************************************************************************/</span>
<a name="l00127"></a>00127 
<a name="l00130"></a>00130 <span class="comment">/***************************************************************************/</span>
<a name="l00171"></a>00171 <span class="keyword">static</span> <span class="keywordtype">void</span> DMA_Prepare(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> channel,
<a name="l00172"></a>00172                         <a class="code" href="group__DMA.html#gf7c5bc2b557c15cabf48a19746df01b7">DMA_CycleCtrl_TypeDef</a> cycleCtrl,
<a name="l00173"></a>00173                         <span class="keywordtype">bool</span> primary,
<a name="l00174"></a>00174                         <span class="keywordtype">bool</span> useBurst,
<a name="l00175"></a>00175                         <span class="keywordtype">void</span> *dst,
<a name="l00176"></a>00176                         <span class="keywordtype">void</span> *src,
<a name="l00177"></a>00177                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nMinus1)
<a name="l00178"></a>00178 {
<a name="l00179"></a>00179   DMA_DESCRIPTOR_TypeDef *descr;
<a name="l00180"></a>00180   DMA_DESCRIPTOR_TypeDef *primDescr;
<a name="l00181"></a>00181   <a class="code" href="structDMA__CB__TypeDef.html">DMA_CB_TypeDef</a>         *cb;
<a name="l00182"></a>00182   uint32_t               inc;
<a name="l00183"></a>00183   uint32_t               chBit;
<a name="l00184"></a>00184   uint32_t               tmp;
<a name="l00185"></a>00185 
<a name="l00186"></a>00186   primDescr = ((DMA_DESCRIPTOR_TypeDef *)(DMA-&gt;CTRLBASE)) + channel;
<a name="l00187"></a>00187 
<a name="l00188"></a>00188   <span class="comment">/* Find descriptor to configure */</span>
<a name="l00189"></a>00189   <span class="keywordflow">if</span> (primary)
<a name="l00190"></a>00190   {
<a name="l00191"></a>00191     descr = primDescr;
<a name="l00192"></a>00192   }
<a name="l00193"></a>00193   <span class="keywordflow">else</span>
<a name="l00194"></a>00194   {
<a name="l00195"></a>00195     descr = ((DMA_DESCRIPTOR_TypeDef *)(DMA-&gt;ALTCTRLBASE)) + channel;
<a name="l00196"></a>00196   }
<a name="l00197"></a>00197 
<a name="l00198"></a>00198   <span class="comment">/* If callback defined, update info on whether callback is issued */</span>
<a name="l00199"></a>00199   <span class="comment">/* for primary or alternate descriptor. Mainly needed for ping-pong */</span>
<a name="l00200"></a>00200   <span class="comment">/* cycles. */</span>
<a name="l00201"></a>00201   cb = (<a class="code" href="structDMA__CB__TypeDef.html">DMA_CB_TypeDef</a> *)(primDescr-&gt;USER);
<a name="l00202"></a>00202   <span class="keywordflow">if</span> (cb)
<a name="l00203"></a>00203   {
<a name="l00204"></a>00204     cb-&gt;<a class="code" href="structDMA__CB__TypeDef.html#ef49c07ddab2e8e1b9c165059defd121">primary</a> = (uint8_t)primary;
<a name="l00205"></a>00205   }
<a name="l00206"></a>00206 
<a name="l00207"></a>00207   <span class="keywordflow">if</span> (src)
<a name="l00208"></a>00208   {
<a name="l00209"></a>00209     inc = (descr-&gt;CTRL &amp; _DMA_CTRL_SRC_INC_MASK) &gt;&gt; _DMA_CTRL_SRC_INC_SHIFT;
<a name="l00210"></a>00210     <span class="keywordflow">if</span> (inc == _DMA_CTRL_SRC_INC_NONE)
<a name="l00211"></a>00211     {
<a name="l00212"></a>00212       descr-&gt;SRCEND = src;
<a name="l00213"></a>00213     }
<a name="l00214"></a>00214     <span class="keywordflow">else</span>
<a name="l00215"></a>00215     {
<a name="l00216"></a>00216       descr-&gt;SRCEND = (<span class="keywordtype">void</span> *)((uint32_t)src + (nMinus1 &lt;&lt; inc));
<a name="l00217"></a>00217     }
<a name="l00218"></a>00218   }
<a name="l00219"></a>00219 
<a name="l00220"></a>00220   <span class="keywordflow">if</span> (dst)
<a name="l00221"></a>00221   {
<a name="l00222"></a>00222     inc = (descr-&gt;CTRL &amp; _DMA_CTRL_DST_INC_MASK) &gt;&gt; _DMA_CTRL_DST_INC_SHIFT;
<a name="l00223"></a>00223     <span class="keywordflow">if</span> (inc == _DMA_CTRL_DST_INC_NONE)
<a name="l00224"></a>00224     {
<a name="l00225"></a>00225       descr-&gt;DSTEND = dst;
<a name="l00226"></a>00226     }
<a name="l00227"></a>00227     <span class="keywordflow">else</span>
<a name="l00228"></a>00228     {
<a name="l00229"></a>00229       descr-&gt;DSTEND = (<span class="keywordtype">void</span> *)((uint32_t)dst + (nMinus1 &lt;&lt; inc));
<a name="l00230"></a>00230     }
<a name="l00231"></a>00231   }
<a name="l00232"></a>00232 
<a name="l00233"></a>00233   chBit = 1 &lt;&lt; channel;
<a name="l00234"></a>00234   <span class="keywordflow">if</span> (useBurst)
<a name="l00235"></a>00235   {
<a name="l00236"></a>00236     DMA-&gt;CHUSEBURSTS = chBit;
<a name="l00237"></a>00237   }
<a name="l00238"></a>00238   <span class="keywordflow">else</span>
<a name="l00239"></a>00239   {
<a name="l00240"></a>00240     DMA-&gt;CHUSEBURSTC = chBit;
<a name="l00241"></a>00241   }
<a name="l00242"></a>00242 
<a name="l00243"></a>00243   <span class="keywordflow">if</span> (primary)
<a name="l00244"></a>00244   {
<a name="l00245"></a>00245     DMA-&gt;CHALTC = chBit;
<a name="l00246"></a>00246   }
<a name="l00247"></a>00247   <span class="keywordflow">else</span>
<a name="l00248"></a>00248   {
<a name="l00249"></a>00249     DMA-&gt;CHALTS = chBit;
<a name="l00250"></a>00250   }
<a name="l00251"></a>00251 
<a name="l00252"></a>00252   <span class="comment">/* Set cycle control */</span>
<a name="l00253"></a>00253   tmp  = descr-&gt;CTRL &amp; ~(_DMA_CTRL_CYCLE_CTRL_MASK | _DMA_CTRL_N_MINUS_1_MASK);
<a name="l00254"></a>00254   tmp |= nMinus1 &lt;&lt; _DMA_CTRL_N_MINUS_1_SHIFT;
<a name="l00255"></a>00255   tmp |= (uint32_t)cycleCtrl &lt;&lt; _DMA_CTRL_CYCLE_CTRL_SHIFT;
<a name="l00256"></a>00256   descr-&gt;CTRL = tmp;
<a name="l00257"></a>00257 }
<a name="l00258"></a>00258 
<a name="l00261"></a>00261 <span class="comment">/*******************************************************************************</span>
<a name="l00262"></a>00262 <span class="comment"> ************************   INTERRUPT FUNCTIONS   ******************************</span>
<a name="l00263"></a>00263 <span class="comment"> ******************************************************************************/</span>
<a name="l00264"></a>00264 
<a name="l00265"></a>00265 <span class="preprocessor">#ifndef EXCLUDE_DEFAULT_DMA_IRQ_HANDLER</span>
<a name="l00266"></a>00266 <span class="preprocessor"></span>
<a name="l00267"></a>00267 <span class="comment">/***************************************************************************/</span>
<a name="l00284"></a><a class="code" href="group__DMA.html#gc1fca8b8a3ce0431d9aebbf432eda751">00284</a> <span class="keywordtype">void</span> <a class="code" href="group__DMA.html#gc1fca8b8a3ce0431d9aebbf432eda751">DMA_IRQHandler</a>(<span class="keywordtype">void</span>)
<a name="l00285"></a>00285 {
<a name="l00286"></a>00286   <span class="keywordtype">int</span>                    channel;
<a name="l00287"></a>00287   <a class="code" href="structDMA__CB__TypeDef.html">DMA_CB_TypeDef</a>         *cb;
<a name="l00288"></a>00288   uint32_t               pending;
<a name="l00289"></a>00289   uint32_t               pendingPrio;
<a name="l00290"></a>00290   uint32_t               prio;
<a name="l00291"></a>00291   uint32_t               primaryCpy;
<a name="l00292"></a>00292   <span class="keywordtype">int</span>                    i;
<a name="l00293"></a>00293 
<a name="l00294"></a>00294   <span class="comment">/* Get all pending and enabled interrupts */</span>
<a name="l00295"></a>00295   pending  = DMA-&gt;IF;
<a name="l00296"></a>00296   pending &amp;= DMA-&gt;IEN;
<a name="l00297"></a>00297 
<a name="l00298"></a>00298   <span class="comment">/* Check for bus error */</span>
<a name="l00299"></a>00299   <span class="keywordflow">if</span> (pending &amp; DMA_IF_ERR)
<a name="l00300"></a>00300   {
<a name="l00301"></a>00301     <span class="comment">/* Loop here to enable the debugger to see what has happened */</span>
<a name="l00302"></a>00302     <span class="keywordflow">while</span> (1)
<a name="l00303"></a>00303       ;
<a name="l00304"></a>00304   }
<a name="l00305"></a>00305 
<a name="l00306"></a>00306   <span class="comment">/* Process all pending channel interrupts. First process channels */</span>
<a name="l00307"></a>00307   <span class="comment">/* defined with high priority, then those with default priority. */</span>
<a name="l00308"></a>00308   prio        = DMA-&gt;CHPRIS;
<a name="l00309"></a>00309   pendingPrio = pending &amp; prio;
<a name="l00310"></a>00310   <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++)
<a name="l00311"></a>00311   {
<a name="l00312"></a>00312     channel = 0;
<a name="l00313"></a>00313     <span class="comment">/* Process pending interrupts within high/default priority group */</span>
<a name="l00314"></a>00314     <span class="comment">/* honouring priority within group. */</span>
<a name="l00315"></a>00315     <span class="keywordflow">while</span> (pendingPrio)
<a name="l00316"></a>00316     {
<a name="l00317"></a>00317       <span class="keywordflow">if</span> (pendingPrio &amp; 1)
<a name="l00318"></a>00318       {
<a name="l00319"></a>00319         DMA_DESCRIPTOR_TypeDef *descr = (DMA_DESCRIPTOR_TypeDef *)(DMA-&gt;CTRLBASE);
<a name="l00320"></a>00320         uint32_t chmask = 1 &lt;&lt; channel;
<a name="l00321"></a>00321 
<a name="l00322"></a>00322         <span class="comment">/* Clear pending interrupt prior to invoking callback, in case it */</span>
<a name="l00323"></a>00323         <span class="comment">/* sets up another DMA cycle. */</span>
<a name="l00324"></a>00324         DMA-&gt;IFC = chmask;
<a name="l00325"></a>00325 
<a name="l00326"></a>00326         <span class="comment">/* Normally, no point in enabling interrupt without callback, but */</span>
<a name="l00327"></a>00327         <span class="comment">/* check if callback is defined anyway. Callback info is always */</span>
<a name="l00328"></a>00328         <span class="comment">/* located in primary descriptor. */</span>
<a name="l00329"></a>00329         cb = (<a class="code" href="structDMA__CB__TypeDef.html">DMA_CB_TypeDef</a> *)(descr[channel].USER);
<a name="l00330"></a>00330         if (cb)
<a name="l00331"></a>00331         {
<a name="l00332"></a>00332           <span class="comment">/* Toggle next-descriptor indicator always prior to invoking */</span>
<a name="l00333"></a>00333           <span class="comment">/* callback (in case callback reconfigurs something) */</span>
<a name="l00334"></a>00334           primaryCpy   = cb-&gt;<a class="code" href="structDMA__CB__TypeDef.html#ef49c07ddab2e8e1b9c165059defd121">primary</a>;
<a name="l00335"></a>00335           cb-&gt;primary ^= 1;
<a name="l00336"></a>00336           if (cb-&gt;cbFunc)
<a name="l00337"></a>00337           {
<a name="l00338"></a>00338             cb-&gt;cbFunc(channel, (<span class="keywordtype">bool</span>)primaryCpy, cb-&gt;userPtr);
<a name="l00339"></a>00339           }
<a name="l00340"></a>00340         }
<a name="l00341"></a>00341       }
<a name="l00342"></a>00342 
<a name="l00343"></a>00343       pendingPrio &gt;&gt;= 1;
<a name="l00344"></a>00344       channel++;
<a name="l00345"></a>00345     }
<a name="l00346"></a>00346 
<a name="l00347"></a>00347     <span class="comment">/* On second iteration, process default priority channels */</span>
<a name="l00348"></a>00348     pendingPrio = pending &amp; ~prio;
<a name="l00349"></a>00349   }
<a name="l00350"></a>00350 }
<a name="l00351"></a>00351 
<a name="l00352"></a>00352 <span class="preprocessor">#endif </span><span class="comment">/* EXCLUDE_DEFAULT_DMA_IRQ_HANDLER */</span>
<a name="l00353"></a>00353 
<a name="l00354"></a>00354 
<a name="l00355"></a>00355 <span class="comment">/*******************************************************************************</span>
<a name="l00356"></a>00356 <span class="comment"> **************************   GLOBAL FUNCTIONS   *******************************</span>
<a name="l00357"></a>00357 <span class="comment"> ******************************************************************************/</span>
<a name="l00358"></a>00358 
<a name="l00359"></a>00359 <span class="comment">/***************************************************************************/</span>
<a name="l00391"></a><a class="code" href="group__DMA.html#gdaa5cd30f373b3e8150b64c26e53f2cd">00391</a> <span class="keywordtype">void</span> <a class="code" href="group__DMA.html#gdaa5cd30f373b3e8150b64c26e53f2cd">DMA_ActivateAuto</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> channel,
<a name="l00392"></a>00392                       <span class="keywordtype">bool</span> primary,
<a name="l00393"></a>00393                       <span class="keywordtype">void</span> *dst,
<a name="l00394"></a>00394                       <span class="keywordtype">void</span> *src,
<a name="l00395"></a>00395                       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nMinus1)
<a name="l00396"></a>00396 {
<a name="l00397"></a>00397   uint32_t chBit;
<a name="l00398"></a>00398 
<a name="l00399"></a>00399   EFM_ASSERT(channel &lt; DMA_CHAN_COUNT);
<a name="l00400"></a>00400   EFM_ASSERT(nMinus1 &lt;= (_DMA_CTRL_N_MINUS_1_MASK &gt;&gt; _DMA_CTRL_N_MINUS_1_SHIFT));
<a name="l00401"></a>00401 
<a name="l00402"></a>00402   DMA_Prepare(channel,
<a name="l00403"></a>00403               <a class="code" href="group__DMA.html#ggf7c5bc2b557c15cabf48a19746df01b7c7297053ebff4cac9f14432d7f3ab066">dmaCycleCtrlAuto</a>,
<a name="l00404"></a>00404               primary,
<a name="l00405"></a>00405               <span class="keyword">false</span>,
<a name="l00406"></a>00406               dst,
<a name="l00407"></a>00407               src,
<a name="l00408"></a>00408               nMinus1);
<a name="l00409"></a>00409 
<a name="l00410"></a>00410   chBit        = 1 &lt;&lt; channel;
<a name="l00411"></a>00411   DMA-&gt;CHENS   = chBit; <span class="comment">/* Enable channel */</span>
<a name="l00412"></a>00412   DMA-&gt;CHSWREQ = chBit; <span class="comment">/* Activate with SW request */</span>
<a name="l00413"></a>00413 }
<a name="l00414"></a>00414 
<a name="l00415"></a>00415 
<a name="l00416"></a>00416 <span class="comment">/***************************************************************************/</span>
<a name="l00454"></a><a class="code" href="group__DMA.html#g6b72fd4e3bcc36e68cca16e5fa243a11">00454</a> <span class="keywordtype">void</span> <a class="code" href="group__DMA.html#g6b72fd4e3bcc36e68cca16e5fa243a11">DMA_ActivateBasic</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> channel,
<a name="l00455"></a>00455                        <span class="keywordtype">bool</span> primary,
<a name="l00456"></a>00456                        <span class="keywordtype">bool</span> useBurst,
<a name="l00457"></a>00457                        <span class="keywordtype">void</span> *dst,
<a name="l00458"></a>00458                        <span class="keywordtype">void</span> *src,
<a name="l00459"></a>00459                        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nMinus1)
<a name="l00460"></a>00460 {
<a name="l00461"></a>00461   EFM_ASSERT(channel &lt; DMA_CHAN_COUNT);
<a name="l00462"></a>00462   EFM_ASSERT(nMinus1 &lt;= (_DMA_CTRL_N_MINUS_1_MASK &gt;&gt; _DMA_CTRL_N_MINUS_1_SHIFT));
<a name="l00463"></a>00463 
<a name="l00464"></a>00464   DMA_Prepare(channel,
<a name="l00465"></a>00465               <a class="code" href="group__DMA.html#ggf7c5bc2b557c15cabf48a19746df01b763be11c241248128c56500a9d7863029">dmaCycleCtrlBasic</a>,
<a name="l00466"></a>00466               primary,
<a name="l00467"></a>00467               useBurst,
<a name="l00468"></a>00468               dst,
<a name="l00469"></a>00469               src,
<a name="l00470"></a>00470               nMinus1);
<a name="l00471"></a>00471 
<a name="l00472"></a>00472   <span class="comment">/* Enable channel, request signal is provided by peripheral device */</span>
<a name="l00473"></a>00473   DMA-&gt;CHENS = 1 &lt;&lt; channel;
<a name="l00474"></a>00474 }
<a name="l00475"></a>00475 
<a name="l00476"></a>00476 
<a name="l00477"></a>00477 <span class="comment">/***************************************************************************/</span>
<a name="l00526"></a><a class="code" href="group__DMA.html#g7dd7d665c343274d70d5e597121b6b05">00526</a> <span class="keywordtype">void</span> <a class="code" href="group__DMA.html#g7dd7d665c343274d70d5e597121b6b05">DMA_ActivatePingPong</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> channel,
<a name="l00527"></a>00527                           <span class="keywordtype">bool</span> useBurst,
<a name="l00528"></a>00528                           <span class="keywordtype">void</span> *primDst,
<a name="l00529"></a>00529                           <span class="keywordtype">void</span> *primSrc,
<a name="l00530"></a>00530                           <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> primNMinus1,
<a name="l00531"></a>00531                           <span class="keywordtype">void</span> *altDst,
<a name="l00532"></a>00532                           <span class="keywordtype">void</span> *altSrc,
<a name="l00533"></a>00533                           <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> altNMinus1)
<a name="l00534"></a>00534 {
<a name="l00535"></a>00535   EFM_ASSERT(channel &lt; DMA_CHAN_COUNT);
<a name="l00536"></a>00536   EFM_ASSERT(primNMinus1 &lt;= (_DMA_CTRL_N_MINUS_1_MASK &gt;&gt; _DMA_CTRL_N_MINUS_1_SHIFT));
<a name="l00537"></a>00537   EFM_ASSERT(altNMinus1 &lt;= (_DMA_CTRL_N_MINUS_1_MASK &gt;&gt; _DMA_CTRL_N_MINUS_1_SHIFT));
<a name="l00538"></a>00538 
<a name="l00539"></a>00539   <span class="comment">/* Prepare alternate descriptor first */</span>
<a name="l00540"></a>00540   DMA_Prepare(channel,
<a name="l00541"></a>00541               <a class="code" href="group__DMA.html#ggf7c5bc2b557c15cabf48a19746df01b7f4331d0c4073d4f24b329bb4b5f0a2fc">dmaCycleCtrlPingPong</a>,
<a name="l00542"></a>00542               <span class="keyword">false</span>,
<a name="l00543"></a>00543               useBurst,
<a name="l00544"></a>00544               altDst,
<a name="l00545"></a>00545               altSrc,
<a name="l00546"></a>00546               altNMinus1);
<a name="l00547"></a>00547 
<a name="l00548"></a>00548   <span class="comment">/* Prepare primary descriptor last in order to start cycle using it */</span>
<a name="l00549"></a>00549   DMA_Prepare(channel,
<a name="l00550"></a>00550               <a class="code" href="group__DMA.html#ggf7c5bc2b557c15cabf48a19746df01b7f4331d0c4073d4f24b329bb4b5f0a2fc">dmaCycleCtrlPingPong</a>,
<a name="l00551"></a>00551               <span class="keyword">true</span>,
<a name="l00552"></a>00552               useBurst,
<a name="l00553"></a>00553               primDst,
<a name="l00554"></a>00554               primSrc,
<a name="l00555"></a>00555               primNMinus1);
<a name="l00556"></a>00556 
<a name="l00557"></a>00557   <span class="comment">/* Enable channel, request signal is provided by peripheral device */</span>
<a name="l00558"></a>00558   DMA-&gt;CHENS = 1 &lt;&lt; channel;
<a name="l00559"></a>00559 }
<a name="l00560"></a>00560 
<a name="l00561"></a>00561 
<a name="l00562"></a>00562 <span class="comment">/***************************************************************************/</span>
<a name="l00596"></a><a class="code" href="group__DMA.html#gbc90358478008982202768d217375a80">00596</a> <span class="keywordtype">void</span> <a class="code" href="group__DMA.html#gbc90358478008982202768d217375a80">DMA_ActivateScatterGather</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> channel,
<a name="l00597"></a>00597                                <span class="keywordtype">bool</span> useBurst,
<a name="l00598"></a>00598                                DMA_DESCRIPTOR_TypeDef *altDescr,
<a name="l00599"></a>00599                                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> count)
<a name="l00600"></a>00600 {
<a name="l00601"></a>00601   DMA_DESCRIPTOR_TypeDef *descr;
<a name="l00602"></a>00602   <a class="code" href="structDMA__CB__TypeDef.html">DMA_CB_TypeDef</a>         *cb;
<a name="l00603"></a>00603   uint32_t               cycleCtrl;
<a name="l00604"></a>00604   uint32_t               chBit;
<a name="l00605"></a>00605 
<a name="l00606"></a>00606   EFM_ASSERT(channel &lt; DMA_CHAN_COUNT);
<a name="l00607"></a>00607   EFM_ASSERT(altDescr);
<a name="l00608"></a>00608   EFM_ASSERT(count &amp;&amp; (count &lt;= 256));
<a name="l00609"></a>00609 
<a name="l00610"></a>00610   <span class="comment">/* We have to configure the primary descriptor properly in order to */</span>
<a name="l00611"></a>00611   <span class="comment">/* transfer one complete alternate descriptor from the alternate */</span>
<a name="l00612"></a>00612   <span class="comment">/* descriptor table into the actual alternate descriptor. */</span>
<a name="l00613"></a>00613   descr = (DMA_DESCRIPTOR_TypeDef *)(DMA-&gt;CTRLBASE) + channel;
<a name="l00614"></a>00614 
<a name="l00615"></a>00615   <span class="comment">/* Set source end address to point to alternate descriptor array */</span>
<a name="l00616"></a>00616   descr-&gt;SRCEND = (uint32_t *)altDescr + (count * 4) - 1;
<a name="l00617"></a>00617 
<a name="l00618"></a>00618   <span class="comment">/* The destination end address in the primary descriptor MUST point */</span>
<a name="l00619"></a>00619   <span class="comment">/* to the corresponding alternate descriptor in scatter-gather mode. */</span>
<a name="l00620"></a>00620   descr-&gt;DSTEND = (uint32_t *)((DMA_DESCRIPTOR_TypeDef *)(DMA-&gt;ALTCTRLBASE) +
<a name="l00621"></a>00621                                channel + 1) - 1;
<a name="l00622"></a>00622 
<a name="l00623"></a>00623   <span class="comment">/* The user field of the descriptor is used for callback configuration, */</span>
<a name="l00624"></a>00624   <span class="comment">/* and already configured when channel is configured. Do not modify it. */</span>
<a name="l00625"></a>00625 
<a name="l00626"></a>00626   <span class="comment">/* Determine from alternate configuration whether this is a memory or */</span>
<a name="l00627"></a>00627   <span class="comment">/* peripheral scatter-gather, by looking at the first alternate descriptor. */</span>
<a name="l00628"></a>00628   cycleCtrl  = altDescr-&gt;CTRL &amp; _DMA_CTRL_CYCLE_CTRL_MASK;
<a name="l00629"></a>00629   cycleCtrl &amp;= ~(1 &lt;&lt; _DMA_CTRL_CYCLE_CTRL_SHIFT);
<a name="l00630"></a>00630 
<a name="l00631"></a>00631   EFM_ASSERT((cycleCtrl == <a class="code" href="group__DMA.html#ggf7c5bc2b557c15cabf48a19746df01b74fcfb852e0cb5792d69f0bf8b42b1e55">dmaCycleCtrlMemScatterGather</a>)
<a name="l00632"></a>00632              || (cycleCtrl == <a class="code" href="group__DMA.html#ggf7c5bc2b557c15cabf48a19746df01b7d5d3b9491d535921b86f9f295426ca95">dmaCycleCtrlPerScatterGather</a>));
<a name="l00633"></a>00633 
<a name="l00634"></a>00634   <span class="comment">/* Set last alternate descriptor to basic or auto-request cycle type in */</span>
<a name="l00635"></a>00635   <span class="comment">/* order to have dma_done signal asserted when complete. Otherwise interrupt */</span>
<a name="l00636"></a>00636   <span class="comment">/* will not be triggered when done. */</span>
<a name="l00637"></a>00637   altDescr[count - 1].CTRL &amp;= ~_DMA_CTRL_CYCLE_CTRL_MASK;
<a name="l00638"></a>00638   <span class="keywordflow">if</span> (cycleCtrl == <a class="code" href="group__DMA.html#ggf7c5bc2b557c15cabf48a19746df01b74fcfb852e0cb5792d69f0bf8b42b1e55">dmaCycleCtrlMemScatterGather</a>)
<a name="l00639"></a>00639   {
<a name="l00640"></a>00640     altDescr[count - 1].CTRL |= (uint32_t)<a class="code" href="group__DMA.html#ggf7c5bc2b557c15cabf48a19746df01b7c7297053ebff4cac9f14432d7f3ab066">dmaCycleCtrlAuto</a>
<a name="l00641"></a>00641                                 &lt;&lt; _DMA_CTRL_CYCLE_CTRL_SHIFT;
<a name="l00642"></a>00642   }
<a name="l00643"></a>00643   <span class="keywordflow">else</span>
<a name="l00644"></a>00644   {
<a name="l00645"></a>00645     altDescr[count - 1].CTRL |= (uint32_t)<a class="code" href="group__DMA.html#ggf7c5bc2b557c15cabf48a19746df01b763be11c241248128c56500a9d7863029">dmaCycleCtrlBasic</a>
<a name="l00646"></a>00646                                 &lt;&lt; _DMA_CTRL_CYCLE_CTRL_SHIFT;
<a name="l00647"></a>00647   }
<a name="l00648"></a>00648 
<a name="l00649"></a>00649   <span class="comment">/* If callback defined, update info on whether callback is issued for */</span>
<a name="l00650"></a>00650   <span class="comment">/* primary or alternate descriptor. Not really useful for scatter-gather, */</span>
<a name="l00651"></a>00651   <span class="comment">/* but do for consistency. Always set to alternate, since that is the last */</span>
<a name="l00652"></a>00652   <span class="comment">/* descriptor actually used. */</span>
<a name="l00653"></a>00653   cb = (<a class="code" href="structDMA__CB__TypeDef.html">DMA_CB_TypeDef</a> *)(descr-&gt;USER);
<a name="l00654"></a>00654   <span class="keywordflow">if</span> (cb)
<a name="l00655"></a>00655   {
<a name="l00656"></a>00656     cb-&gt;<a class="code" href="structDMA__CB__TypeDef.html#ef49c07ddab2e8e1b9c165059defd121">primary</a> = <span class="keyword">false</span>;
<a name="l00657"></a>00657   }
<a name="l00658"></a>00658 
<a name="l00659"></a>00659   <span class="comment">/* Configure primary descriptor control word */</span>
<a name="l00660"></a>00660   descr-&gt;CTRL =((uint32_t)<a class="code" href="group__DMA.html#ggade1a68a6cbf32800b8ac4046a13398807edd8fc13175289dd2e6ac5e14a1044">dmaDataInc4</a> &lt;&lt; _DMA_CTRL_DST_INC_SHIFT)
<a name="l00661"></a>00661                | ((uint32_t)<a class="code" href="group__DMA.html#gg19fed692b981a8dc7e3a5d6b0f281540f372081fe5f67e55ac6ac355eaa2c7ba">dmaDataSize4</a> &lt;&lt; _DMA_CTRL_DST_SIZE_SHIFT)
<a name="l00662"></a>00662                | ((uint32_t)<a class="code" href="group__DMA.html#ggade1a68a6cbf32800b8ac4046a13398807edd8fc13175289dd2e6ac5e14a1044">dmaDataInc4</a> &lt;&lt; _DMA_CTRL_SRC_INC_SHIFT)
<a name="l00663"></a>00663                | ((uint32_t)<a class="code" href="group__DMA.html#gg19fed692b981a8dc7e3a5d6b0f281540f372081fe5f67e55ac6ac355eaa2c7ba">dmaDataSize4</a> &lt;&lt; _DMA_CTRL_SRC_SIZE_SHIFT)
<a name="l00664"></a>00664                <span class="comment">/* Use same protection scheme as for alternate descriptors */</span>
<a name="l00665"></a>00665                | (altDescr-&gt;CTRL &amp; _DMA_CTRL_SRC_PROT_CTRL_MASK)
<a name="l00666"></a>00666                | ((uint32_t)<a class="code" href="group__DMA.html#gg0b815384b08ec6721a23eb8a29db0c59e396a4df34f0a830a44dda7d2cb4bbe9">dmaArbitrate4</a> &lt;&lt; _DMA_CTRL_R_POWER_SHIFT)
<a name="l00667"></a>00667                | (((count * 4) - 1) &lt;&lt; _DMA_CTRL_N_MINUS_1_SHIFT)
<a name="l00668"></a>00668                | (((uint32_t)useBurst &amp; 1) &lt;&lt; _DMA_CTRL_NEXT_USEBURST_SHIFT)
<a name="l00669"></a>00669                | cycleCtrl;
<a name="l00670"></a>00670 
<a name="l00671"></a>00671   chBit = 1 &lt;&lt; channel;
<a name="l00672"></a>00672 
<a name="l00673"></a>00673   <span class="comment">/* Start with primary descriptor */</span>
<a name="l00674"></a>00674   DMA-&gt;CHALTC = chBit;
<a name="l00675"></a>00675 
<a name="l00676"></a>00676   <span class="comment">/* Enable channel */</span>
<a name="l00677"></a>00677   DMA-&gt;CHENS = chBit;
<a name="l00678"></a>00678 
<a name="l00679"></a>00679   <span class="comment">/* Send request if memory scatter-gather, otherwise request signal is */</span>
<a name="l00680"></a>00680   <span class="comment">/* provided by peripheral. */</span>
<a name="l00681"></a>00681   <span class="keywordflow">if</span> (cycleCtrl == <a class="code" href="group__DMA.html#ggf7c5bc2b557c15cabf48a19746df01b74fcfb852e0cb5792d69f0bf8b42b1e55">dmaCycleCtrlMemScatterGather</a>)
<a name="l00682"></a>00682   {
<a name="l00683"></a>00683     DMA-&gt;CHSWREQ = chBit;
<a name="l00684"></a>00684   }
<a name="l00685"></a>00685 }
<a name="l00686"></a>00686 
<a name="l00687"></a>00687 
<a name="l00688"></a>00688 <span class="comment">/***************************************************************************/</span>
<a name="l00706"></a><a class="code" href="group__DMA.html#gb119fe5869e7ebcfd29542d05dae2d29">00706</a> <span class="keywordtype">void</span> <a class="code" href="group__DMA.html#gb119fe5869e7ebcfd29542d05dae2d29">DMA_CfgChannel</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> channel, <a class="code" href="structDMA__CfgChannel__TypeDef.html">DMA_CfgChannel_TypeDef</a> *cfg)
<a name="l00707"></a>00707 {
<a name="l00708"></a>00708   DMA_DESCRIPTOR_TypeDef *descr;
<a name="l00709"></a>00709 
<a name="l00710"></a>00710   EFM_ASSERT(channel &lt; DMA_CHAN_COUNT);
<a name="l00711"></a>00711   EFM_ASSERT(cfg);
<a name="l00712"></a>00712 
<a name="l00713"></a>00713   <span class="comment">/* Always keep callback configuration reference in primary descriptor */</span>
<a name="l00714"></a>00714   descr               = (DMA_DESCRIPTOR_TypeDef *)(DMA-&gt;CTRLBASE);
<a name="l00715"></a>00715   descr[channel].USER = (uint32_t)(cfg-&gt;<a class="code" href="structDMA__CfgChannel__TypeDef.html#78962c32d00b2867da5e1df1aa2898af">cb</a>);
<a name="l00716"></a>00716 
<a name="l00717"></a>00717   <span class="comment">/* Set to specified priority for channel */</span>
<a name="l00718"></a>00718   <span class="keywordflow">if</span> (cfg-&gt;<a class="code" href="structDMA__CfgChannel__TypeDef.html#2ab5794514b10a171b2cdc5588a4c1c3">highPri</a>)
<a name="l00719"></a>00719   {
<a name="l00720"></a>00720     DMA-&gt;CHPRIS = 1 &lt;&lt; channel;
<a name="l00721"></a>00721   }
<a name="l00722"></a>00722   <span class="keywordflow">else</span>
<a name="l00723"></a>00723   {
<a name="l00724"></a>00724     DMA-&gt;CHPRIC = 1 &lt;&lt; channel;
<a name="l00725"></a>00725   }
<a name="l00726"></a>00726 
<a name="l00727"></a>00727   <span class="comment">/* Set DMA signal source select */</span>
<a name="l00728"></a>00728   DMA-&gt;CH[channel].CTRL = cfg-&gt;<a class="code" href="structDMA__CfgChannel__TypeDef.html#8154995dc0842c9445da5450b8817b77">select</a>;
<a name="l00729"></a>00729 
<a name="l00730"></a>00730   <span class="comment">/* Enable/disable interrupt as specified */</span>
<a name="l00731"></a>00731   <span class="keywordflow">if</span> (cfg-&gt;<a class="code" href="structDMA__CfgChannel__TypeDef.html#e3311c1a3062167007e12c5962a317ed">enableInt</a>)
<a name="l00732"></a>00732   {
<a name="l00733"></a>00733     DMA-&gt;IFC = (1 &lt;&lt; channel);
<a name="l00734"></a>00734     <a class="code" href="group__BUS.html#gf8574f14855448ecae32c5a9dd0c7164">BUS_RegBitWrite</a>(&amp;(DMA-&gt;IEN), channel, 1);
<a name="l00735"></a>00735   }
<a name="l00736"></a>00736   <span class="keywordflow">else</span>
<a name="l00737"></a>00737   {
<a name="l00738"></a>00738     <a class="code" href="group__BUS.html#gf8574f14855448ecae32c5a9dd0c7164">BUS_RegBitWrite</a>(&amp;(DMA-&gt;IEN), channel, 0);
<a name="l00739"></a>00739   }
<a name="l00740"></a>00740 }
<a name="l00741"></a>00741 
<a name="l00742"></a>00742 
<a name="l00743"></a>00743 <span class="comment">/***************************************************************************/</span>
<a name="l00781"></a><a class="code" href="group__DMA.html#g6595eabbd98c16c3d610eebb88daf052">00781</a> <span class="keywordtype">void</span> <a class="code" href="group__DMA.html#g6595eabbd98c16c3d610eebb88daf052">DMA_CfgDescr</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> channel,
<a name="l00782"></a>00782                   <span class="keywordtype">bool</span> primary,
<a name="l00783"></a>00783                   <a class="code" href="structDMA__CfgDescr__TypeDef.html">DMA_CfgDescr_TypeDef</a> *cfg)
<a name="l00784"></a>00784 {
<a name="l00785"></a>00785   DMA_DESCRIPTOR_TypeDef *descr;
<a name="l00786"></a>00786 
<a name="l00787"></a>00787   EFM_ASSERT(channel &lt; DMA_CHAN_COUNT);
<a name="l00788"></a>00788   EFM_ASSERT(cfg);
<a name="l00789"></a>00789 
<a name="l00790"></a>00790   <span class="comment">/* Find descriptor to configure */</span>
<a name="l00791"></a>00791   <span class="keywordflow">if</span> (primary)
<a name="l00792"></a>00792   {
<a name="l00793"></a>00793     descr = (DMA_DESCRIPTOR_TypeDef *)DMA-&gt;CTRLBASE;
<a name="l00794"></a>00794   }
<a name="l00795"></a>00795   <span class="keywordflow">else</span>
<a name="l00796"></a>00796   {
<a name="l00797"></a>00797     descr = (DMA_DESCRIPTOR_TypeDef *)DMA-&gt;ALTCTRLBASE;
<a name="l00798"></a>00798   }
<a name="l00799"></a>00799   descr += channel;
<a name="l00800"></a>00800 
<a name="l00801"></a>00801   <span class="comment">/* Prepare the descriptor */</span>
<a name="l00802"></a>00802   <span class="comment">/* Source/destination end addresses set when started */</span>
<a name="l00803"></a>00803   descr-&gt;CTRL = (cfg-&gt;<a class="code" href="structDMA__CfgDescr__TypeDef.html#593b83ca22f666dc278598e91823e1e8">dstInc</a> &lt;&lt; _DMA_CTRL_DST_INC_SHIFT)
<a name="l00804"></a>00804                 | (cfg-&gt;<a class="code" href="structDMA__CfgDescr__TypeDef.html#7dfe8066fe5a4c7c24b8a3d7ba7af307">size</a> &lt;&lt; _DMA_CTRL_DST_SIZE_SHIFT)
<a name="l00805"></a>00805                 | (cfg-&gt;<a class="code" href="structDMA__CfgDescr__TypeDef.html#5adb304f0f371a465c9a524322db02e9">srcInc</a> &lt;&lt; _DMA_CTRL_SRC_INC_SHIFT)
<a name="l00806"></a>00806                 | (cfg-&gt;<a class="code" href="structDMA__CfgDescr__TypeDef.html#7dfe8066fe5a4c7c24b8a3d7ba7af307">size</a> &lt;&lt; _DMA_CTRL_SRC_SIZE_SHIFT)
<a name="l00807"></a>00807                 | ((uint32_t)(cfg-&gt;<a class="code" href="structDMA__CfgDescr__TypeDef.html#24cd2bca792ea31c9744ede714cd2298">hprot</a>) &lt;&lt; _DMA_CTRL_SRC_PROT_CTRL_SHIFT)
<a name="l00808"></a>00808                 | (cfg-&gt;<a class="code" href="structDMA__CfgDescr__TypeDef.html#415afa217ec9a94adbbea7df76fbe161">arbRate</a> &lt;&lt; _DMA_CTRL_R_POWER_SHIFT)
<a name="l00809"></a>00809                 | (0 &lt;&lt; _DMA_CTRL_N_MINUS_1_SHIFT)     <span class="comment">/* Set when activated */</span>
<a name="l00810"></a>00810                 | (0 &lt;&lt; _DMA_CTRL_NEXT_USEBURST_SHIFT) <span class="comment">/* Set when activated */</span>
<a name="l00811"></a>00811                 | DMA_CTRL_CYCLE_CTRL_INVALID;         <span class="comment">/* Set when activated */</span>
<a name="l00812"></a>00812 }
<a name="l00813"></a>00813 
<a name="l00814"></a>00814 
<a name="l00815"></a>00815 <span class="preprocessor">#if defined( _DMA_LOOP0_MASK ) &amp;&amp; defined( _DMA_LOOP1_MASK )</span>
<a name="l00816"></a>00816 <span class="preprocessor"></span><span class="comment">/***************************************************************************/</span>
<a name="l00829"></a><a class="code" href="group__DMA.html#gd7793e946a1d7c1e4d7c350d959ee274">00829</a> <span class="keywordtype">void</span> <a class="code" href="group__DMA.html#gd7793e946a1d7c1e4d7c350d959ee274">DMA_CfgLoop</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> channel, <a class="code" href="structDMA__CfgLoop__TypeDef.html">DMA_CfgLoop_TypeDef</a> *cfg)
<a name="l00830"></a>00830 {
<a name="l00831"></a>00831   EFM_ASSERT(channel &lt;= 1);
<a name="l00832"></a>00832   EFM_ASSERT(cfg-&gt;<a class="code" href="structDMA__CfgLoop__TypeDef.html#69fe0908e51acbb95ec41d1522b44471">nMinus1</a> &lt;= 1023);
<a name="l00833"></a>00833 
<a name="l00834"></a>00834   <span class="comment">/* Configure LOOP setting */</span>
<a name="l00835"></a>00835   <span class="keywordflow">switch</span>( channel )
<a name="l00836"></a>00836   {
<a name="l00837"></a>00837   <span class="keywordflow">case</span> 0:
<a name="l00838"></a>00838     DMA-&gt;LOOP0 = (cfg-&gt;<a class="code" href="structDMA__CfgLoop__TypeDef.html#71e02b226e8e96572d71c1184cd8c0d4">enable</a> &lt;&lt; _DMA_LOOP0_EN_SHIFT)
<a name="l00839"></a>00839                  | (cfg-&gt;<a class="code" href="structDMA__CfgLoop__TypeDef.html#69fe0908e51acbb95ec41d1522b44471">nMinus1</a> &lt;&lt; _DMA_LOOP0_WIDTH_SHIFT);
<a name="l00840"></a>00840     <span class="keywordflow">break</span>;
<a name="l00841"></a>00841   <span class="keywordflow">case</span> 1:
<a name="l00842"></a>00842     DMA-&gt;LOOP1 = (cfg-&gt;<a class="code" href="structDMA__CfgLoop__TypeDef.html#71e02b226e8e96572d71c1184cd8c0d4">enable</a> &lt;&lt; _DMA_LOOP1_EN_SHIFT)
<a name="l00843"></a>00843                  | (cfg-&gt;<a class="code" href="structDMA__CfgLoop__TypeDef.html#69fe0908e51acbb95ec41d1522b44471">nMinus1</a> &lt;&lt; _DMA_LOOP1_WIDTH_SHIFT);
<a name="l00844"></a>00844     <span class="keywordflow">break</span>;
<a name="l00845"></a>00845   }
<a name="l00846"></a>00846 }
<a name="l00847"></a>00847 <span class="preprocessor">#endif</span>
<a name="l00848"></a>00848 <span class="preprocessor"></span>
<a name="l00849"></a>00849 
<a name="l00850"></a>00850 <span class="preprocessor">#if defined( _DMA_RECT0_MASK )</span>
<a name="l00851"></a>00851 <span class="preprocessor"></span><span class="comment">/***************************************************************************/</span>
<a name="l00860"></a><a class="code" href="group__DMA.html#gbef8d6b3c273171902e71c02d6df8f6d">00860</a> <span class="keywordtype">void</span> <a class="code" href="group__DMA.html#gbef8d6b3c273171902e71c02d6df8f6d">DMA_CfgRect</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> channel, <a class="code" href="structDMA__CfgRect__TypeDef.html">DMA_CfgRect_TypeDef</a> *cfg)
<a name="l00861"></a>00861 {
<a name="l00862"></a>00862   (void)channel;                            <span class="comment">/* Unused parameter */</span>
<a name="l00863"></a>00863 
<a name="l00864"></a>00864   EFM_ASSERT(channel == 0);
<a name="l00865"></a>00865   EFM_ASSERT(cfg-&gt;<a class="code" href="structDMA__CfgRect__TypeDef.html#f6e26f9f2eb369d71f7cac9259d25c48">dstStride</a> &lt;= 2047);
<a name="l00866"></a>00866   EFM_ASSERT(cfg-&gt;<a class="code" href="structDMA__CfgRect__TypeDef.html#c3ba03869692936d97612842e047c637">srcStride</a> &lt;= 2047);
<a name="l00867"></a>00867   EFM_ASSERT(cfg-&gt;<a class="code" href="structDMA__CfgRect__TypeDef.html#47e87a79ee614178b027a192c9665a71">height</a> &lt;= 1023);
<a name="l00868"></a>00868 
<a name="l00869"></a>00869   <span class="comment">/* Configure rectangular/2D copy */</span>
<a name="l00870"></a>00870   DMA-&gt;RECT0 =  (cfg-&gt;<a class="code" href="structDMA__CfgRect__TypeDef.html#f6e26f9f2eb369d71f7cac9259d25c48">dstStride</a> &lt;&lt; _DMA_RECT0_DSTSTRIDE_SHIFT)
<a name="l00871"></a>00871                 | (cfg-&gt;<a class="code" href="structDMA__CfgRect__TypeDef.html#c3ba03869692936d97612842e047c637">srcStride</a> &lt;&lt; _DMA_RECT0_SRCSTRIDE_SHIFT)
<a name="l00872"></a>00872                 | (cfg-&gt;<a class="code" href="structDMA__CfgRect__TypeDef.html#47e87a79ee614178b027a192c9665a71">height</a> &lt;&lt; _DMA_RECT0_HEIGHT_SHIFT);
<a name="l00873"></a>00873 }
<a name="l00874"></a>00874 <span class="preprocessor">#endif</span>
<a name="l00875"></a>00875 <span class="preprocessor"></span>
<a name="l00876"></a>00876 
<a name="l00877"></a>00877 <span class="comment">/***************************************************************************/</span>
<a name="l00903"></a><a class="code" href="group__DMA.html#gc365a3587fa185c9b32b549ed8e8dc23">00903</a> <span class="keywordtype">void</span> <a class="code" href="group__DMA.html#gc365a3587fa185c9b32b549ed8e8dc23">DMA_CfgDescrScatterGather</a>(DMA_DESCRIPTOR_TypeDef *descr,
<a name="l00904"></a>00904                                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indx,
<a name="l00905"></a>00905                                <a class="code" href="structDMA__CfgDescrSGAlt__TypeDef.html">DMA_CfgDescrSGAlt_TypeDef</a> *cfg)
<a name="l00906"></a>00906 {
<a name="l00907"></a>00907   uint32_t cycleCtrl;
<a name="l00908"></a>00908 
<a name="l00909"></a>00909   EFM_ASSERT(descr);
<a name="l00910"></a>00910   EFM_ASSERT(cfg);
<a name="l00911"></a>00911 
<a name="l00912"></a>00912   <span class="comment">/* Point to selected entry in alternate descriptor table */</span>
<a name="l00913"></a>00913   descr += indx;
<a name="l00914"></a>00914 
<a name="l00915"></a>00915   <span class="keywordflow">if</span> (cfg-&gt;<a class="code" href="structDMA__CfgDescrSGAlt__TypeDef.html#4046012b0b6a4225edcd307a06a7f5df">srcInc</a> == <a class="code" href="group__DMA.html#ggade1a68a6cbf32800b8ac4046a13398856ebf7629a95d65ff0c5a40030cc6102">dmaDataIncNone</a>)
<a name="l00916"></a>00916   {
<a name="l00917"></a>00917     descr-&gt;SRCEND = cfg-&gt;<a class="code" href="structDMA__CfgDescrSGAlt__TypeDef.html#e37ddd775a13dc551cf13c8a8ead63aa">src</a>;
<a name="l00918"></a>00918   }
<a name="l00919"></a>00919   <span class="keywordflow">else</span>
<a name="l00920"></a>00920   {
<a name="l00921"></a>00921     descr-&gt;SRCEND = (<span class="keywordtype">void</span> *)((uint32_t)(cfg-&gt;<a class="code" href="structDMA__CfgDescrSGAlt__TypeDef.html#e37ddd775a13dc551cf13c8a8ead63aa">src</a>)
<a name="l00922"></a>00922                              + ((uint32_t)(cfg-&gt;<a class="code" href="structDMA__CfgDescrSGAlt__TypeDef.html#682f64b8005ac966a25f71c22781ad17">nMinus1</a>) &lt;&lt; cfg-&gt;<a class="code" href="structDMA__CfgDescrSGAlt__TypeDef.html#4046012b0b6a4225edcd307a06a7f5df">srcInc</a>));
<a name="l00923"></a>00923   }
<a name="l00924"></a>00924 
<a name="l00925"></a>00925   <span class="keywordflow">if</span> (cfg-&gt;<a class="code" href="structDMA__CfgDescrSGAlt__TypeDef.html#4099c38e0d4fd7fddb59fa46bf65009b">dstInc</a> == <a class="code" href="group__DMA.html#ggade1a68a6cbf32800b8ac4046a13398856ebf7629a95d65ff0c5a40030cc6102">dmaDataIncNone</a>)
<a name="l00926"></a>00926   {
<a name="l00927"></a>00927     descr-&gt;DSTEND = cfg-&gt;<a class="code" href="structDMA__CfgDescrSGAlt__TypeDef.html#3933ac2d338fce426818f248f4fcafac">dst</a>;
<a name="l00928"></a>00928   }
<a name="l00929"></a>00929   <span class="keywordflow">else</span>
<a name="l00930"></a>00930   {
<a name="l00931"></a>00931     descr-&gt;DSTEND = (<span class="keywordtype">void</span> *)((uint32_t)(cfg-&gt;<a class="code" href="structDMA__CfgDescrSGAlt__TypeDef.html#3933ac2d338fce426818f248f4fcafac">dst</a>)
<a name="l00932"></a>00932                              + ((uint32_t)(cfg-&gt;<a class="code" href="structDMA__CfgDescrSGAlt__TypeDef.html#682f64b8005ac966a25f71c22781ad17">nMinus1</a>) &lt;&lt; cfg-&gt;<a class="code" href="structDMA__CfgDescrSGAlt__TypeDef.html#4099c38e0d4fd7fddb59fa46bf65009b">dstInc</a>));
<a name="l00933"></a>00933   }
<a name="l00934"></a>00934 
<a name="l00935"></a>00935   <span class="comment">/* User definable part not used */</span>
<a name="l00936"></a>00936   descr-&gt;USER = 0;
<a name="l00937"></a>00937 
<a name="l00938"></a>00938   <span class="keywordflow">if</span> (cfg-&gt;<a class="code" href="structDMA__CfgDescrSGAlt__TypeDef.html#e772b4145bf98c306ccd9e220d20eb5b">peripheral</a>)
<a name="l00939"></a>00939   {
<a name="l00940"></a>00940     cycleCtrl = (uint32_t)<a class="code" href="group__DMA.html#ggf7c5bc2b557c15cabf48a19746df01b7d5d3b9491d535921b86f9f295426ca95">dmaCycleCtrlPerScatterGather</a> + 1;
<a name="l00941"></a>00941   }
<a name="l00942"></a>00942   <span class="keywordflow">else</span>
<a name="l00943"></a>00943   {
<a name="l00944"></a>00944     cycleCtrl = (uint32_t)<a class="code" href="group__DMA.html#ggf7c5bc2b557c15cabf48a19746df01b74fcfb852e0cb5792d69f0bf8b42b1e55">dmaCycleCtrlMemScatterGather</a> + 1;
<a name="l00945"></a>00945   }
<a name="l00946"></a>00946 
<a name="l00947"></a>00947   descr-&gt;CTRL =(cfg-&gt;<a class="code" href="structDMA__CfgDescrSGAlt__TypeDef.html#4099c38e0d4fd7fddb59fa46bf65009b">dstInc</a> &lt;&lt; _DMA_CTRL_DST_INC_SHIFT)
<a name="l00948"></a>00948                | (cfg-&gt;<a class="code" href="structDMA__CfgDescrSGAlt__TypeDef.html#8421dbcb86ace297e5dfc5d0ac1b0745">size</a> &lt;&lt; _DMA_CTRL_DST_SIZE_SHIFT)
<a name="l00949"></a>00949                | (cfg-&gt;<a class="code" href="structDMA__CfgDescrSGAlt__TypeDef.html#4046012b0b6a4225edcd307a06a7f5df">srcInc</a> &lt;&lt; _DMA_CTRL_SRC_INC_SHIFT)
<a name="l00950"></a>00950                | (cfg-&gt;<a class="code" href="structDMA__CfgDescrSGAlt__TypeDef.html#8421dbcb86ace297e5dfc5d0ac1b0745">size</a> &lt;&lt; _DMA_CTRL_SRC_SIZE_SHIFT)
<a name="l00951"></a>00951                | ((uint32_t)(cfg-&gt;<a class="code" href="structDMA__CfgDescrSGAlt__TypeDef.html#1e4b02d52d2c25d644523398f92c71c9">hprot</a>) &lt;&lt; _DMA_CTRL_SRC_PROT_CTRL_SHIFT)
<a name="l00952"></a>00952                | (cfg-&gt;<a class="code" href="structDMA__CfgDescrSGAlt__TypeDef.html#11927ca5e753b91a064ffa6648589949">arbRate</a> &lt;&lt; _DMA_CTRL_R_POWER_SHIFT)
<a name="l00953"></a>00953                | ((uint32_t)(cfg-&gt;<a class="code" href="structDMA__CfgDescrSGAlt__TypeDef.html#682f64b8005ac966a25f71c22781ad17">nMinus1</a>) &lt;&lt; _DMA_CTRL_N_MINUS_1_SHIFT)
<a name="l00954"></a>00954     <span class="comment">/* Never set next useburst bit, since the descriptor used after the */</span>
<a name="l00955"></a>00955     <span class="comment">/* alternate descriptor is the primary descriptor which operates on */</span>
<a name="l00956"></a>00956     <span class="comment">/* memory. If the alternate descriptors need to have useBurst set, this */</span>
<a name="l00957"></a>00957     <span class="comment">/* done when setting up the primary descriptor, ie when activating. */</span>
<a name="l00958"></a>00958                | (0 &lt;&lt; _DMA_CTRL_NEXT_USEBURST_SHIFT)
<a name="l00959"></a>00959                | (cycleCtrl &lt;&lt; _DMA_CTRL_CYCLE_CTRL_SHIFT);
<a name="l00960"></a>00960 }
<a name="l00961"></a>00961 
<a name="l00962"></a>00962 
<a name="l00963"></a>00963 <span class="comment">/***************************************************************************/</span>
<a name="l00979"></a><a class="code" href="group__DMA.html#gb7d47175069b1952534467bf115eb02e">00979</a> <span class="keywordtype">void</span> <a class="code" href="group__DMA.html#gb7d47175069b1952534467bf115eb02e">DMA_ChannelEnable</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> channel, <span class="keywordtype">bool</span> enable)
<a name="l00980"></a>00980 {
<a name="l00981"></a>00981   EFM_ASSERT(channel &lt; DMA_CHAN_COUNT);
<a name="l00982"></a>00982 
<a name="l00983"></a>00983   <span class="keywordflow">if</span> (enable)
<a name="l00984"></a>00984   {
<a name="l00985"></a>00985     DMA-&gt;CHENS = 1&lt;&lt;channel;
<a name="l00986"></a>00986   }
<a name="l00987"></a>00987   <span class="keywordflow">else</span>
<a name="l00988"></a>00988   {
<a name="l00989"></a>00989     DMA-&gt;CHENC = 1&lt;&lt;channel;
<a name="l00990"></a>00990   }
<a name="l00991"></a>00991 }
<a name="l00992"></a>00992 
<a name="l00993"></a>00993 
<a name="l00994"></a>00994 <span class="comment">/***************************************************************************/</span>
<a name="l01008"></a><a class="code" href="group__DMA.html#gd699a3954c696e5523826c04befb6db5">01008</a> <span class="keywordtype">bool</span> <a class="code" href="group__DMA.html#gd699a3954c696e5523826c04befb6db5">DMA_ChannelEnabled</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> channel)
<a name="l01009"></a>01009 {
<a name="l01010"></a>01010   EFM_ASSERT(channel &lt; DMA_CHAN_COUNT);
<a name="l01011"></a>01011 
<a name="l01012"></a>01012   <span class="keywordflow">return</span> (<span class="keywordtype">bool</span>)((DMA-&gt;CHENS &gt;&gt; channel) &amp; 1);
<a name="l01013"></a>01013 }
<a name="l01014"></a>01014 
<a name="l01015"></a>01015 
<a name="l01016"></a>01016 <span class="comment">/***************************************************************************/</span>
<a name="l01033"></a><a class="code" href="group__DMA.html#g1b244c27cc74059907a25a806eac9b90">01033</a> <span class="keywordtype">void</span> <a class="code" href="group__DMA.html#g1b244c27cc74059907a25a806eac9b90">DMA_Init</a>(<a class="code" href="structDMA__Init__TypeDef.html">DMA_Init_TypeDef</a> *init)
<a name="l01034"></a>01034 {
<a name="l01035"></a>01035   EFM_ASSERT(init);
<a name="l01036"></a>01036 
<a name="l01037"></a>01037   <span class="comment">/* Make sure control block is properly aligned */</span>
<a name="l01038"></a>01038 <span class="preprocessor">#if (DMA_CHAN_COUNT &lt;= 4)</span>
<a name="l01039"></a>01039 <span class="preprocessor"></span>  EFM_ASSERT(!((uint32_t)(init-&gt;<a class="code" href="structDMA__Init__TypeDef.html#f4145fb76dfb19fa13bd7873bc35f5ce">controlBlock</a>) &amp; (128 - 1)));
<a name="l01040"></a>01040 <span class="preprocessor">#elif (DMA_CHAN_COUNT &lt;= 8) || (DMA_CHAN_COUNT &lt;= 12)</span>
<a name="l01041"></a>01041 <span class="preprocessor"></span>  EFM_ASSERT(!((uint32_t)(init-&gt;<a class="code" href="structDMA__Init__TypeDef.html#f4145fb76dfb19fa13bd7873bc35f5ce">controlBlock</a>) &amp; (256 - 1)));
<a name="l01042"></a>01042 <span class="preprocessor">#else</span>
<a name="l01043"></a>01043 <span class="preprocessor"></span><span class="preprocessor">#error "Unsupported DMA channel count (em_dma.c)."</span>
<a name="l01044"></a>01044 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l01045"></a>01045 <span class="preprocessor"></span>
<a name="l01046"></a>01046   <span class="comment">/* Make sure DMA clock is enabled prior to accessing DMA module */</span>
<a name="l01047"></a>01047   <a class="code" href="group__CMU.html#g93913d50050d52b38b0a7c7c08ac81e8">CMU_ClockEnable</a>(<a class="code" href="group__CMU.html#gg519ea66a1a21e07f2d1cccc9aa55799e6f64be54830f8f2c8f40192330ab2eb0">cmuClock_DMA</a>, <span class="keyword">true</span>);
<a name="l01048"></a>01048 
<a name="l01049"></a>01049   <span class="comment">/* Make sure DMA controller is set to a known reset state */</span>
<a name="l01050"></a>01050   <a class="code" href="group__DMA.html#g35a483de1c773d6cd958434372054b8b">DMA_Reset</a>();
<a name="l01051"></a>01051 
<a name="l01052"></a>01052   <span class="comment">/* Clear/enable DMA interrupts */</span>
<a name="l01053"></a>01053   NVIC_ClearPendingIRQ(DMA_IRQn);
<a name="l01054"></a>01054   NVIC_EnableIRQ(DMA_IRQn);
<a name="l01055"></a>01055 
<a name="l01056"></a>01056   <span class="comment">/* Enable bus error interrupt */</span>
<a name="l01057"></a>01057   DMA-&gt;IEN = DMA_IEN_ERR;
<a name="l01058"></a>01058 
<a name="l01059"></a>01059   <span class="comment">/* Set pointer to control block, notice that this ptr must have been */</span>
<a name="l01060"></a>01060   <span class="comment">/* properly aligned, according to requirements defined in the reference */</span>
<a name="l01061"></a>01061   <span class="comment">/* manual. */</span>
<a name="l01062"></a>01062   DMA-&gt;CTRLBASE = (uint32_t)(init-&gt;<a class="code" href="structDMA__Init__TypeDef.html#f4145fb76dfb19fa13bd7873bc35f5ce">controlBlock</a>);
<a name="l01063"></a>01063 
<a name="l01064"></a>01064   <span class="comment">/* Configure and enable the DMA controller */</span>
<a name="l01065"></a>01065   DMA-&gt;CONFIG = ((uint32_t)(init-&gt;<a class="code" href="structDMA__Init__TypeDef.html#5f223fedb2ef5d2a8e7b219631520c4d">hprot</a>) &lt;&lt; _DMA_CONFIG_CHPROT_SHIFT)
<a name="l01066"></a>01066                 | DMA_CONFIG_EN;
<a name="l01067"></a>01067 }
<a name="l01068"></a>01068 
<a name="l01069"></a>01069 
<a name="l01070"></a>01070 <span class="comment">/***************************************************************************/</span>
<a name="l01111"></a><a class="code" href="group__DMA.html#g98484c1f3ff4ca1bef804b1d35f387bd">01111</a> <span class="keywordtype">void</span> <a class="code" href="group__DMA.html#g98484c1f3ff4ca1bef804b1d35f387bd">DMA_RefreshPingPong</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> channel,
<a name="l01112"></a>01112                          <span class="keywordtype">bool</span> primary,
<a name="l01113"></a>01113                          <span class="keywordtype">bool</span> useBurst,
<a name="l01114"></a>01114                          <span class="keywordtype">void</span> *dst,
<a name="l01115"></a>01115                          <span class="keywordtype">void</span> *src,
<a name="l01116"></a>01116                          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nMinus1,
<a name="l01117"></a>01117                          <span class="keywordtype">bool</span> stop)
<a name="l01118"></a>01118 {
<a name="l01119"></a>01119   <a class="code" href="group__DMA.html#gf7c5bc2b557c15cabf48a19746df01b7">DMA_CycleCtrl_TypeDef</a>  cycleCtrl;
<a name="l01120"></a>01120   DMA_DESCRIPTOR_TypeDef *descr;
<a name="l01121"></a>01121   uint32_t               inc;
<a name="l01122"></a>01122   uint32_t               chBit;
<a name="l01123"></a>01123   uint32_t               tmp;
<a name="l01124"></a>01124 
<a name="l01125"></a>01125   EFM_ASSERT(channel &lt; DMA_CHAN_COUNT);
<a name="l01126"></a>01126   EFM_ASSERT(nMinus1 &lt;= (_DMA_CTRL_N_MINUS_1_MASK &gt;&gt; _DMA_CTRL_N_MINUS_1_SHIFT));
<a name="l01127"></a>01127 
<a name="l01128"></a>01128   <span class="comment">/* The ping-pong DMA cycle may be stopped by issuing a basic cycle type */</span>
<a name="l01129"></a>01129   <span class="keywordflow">if</span> (stop)
<a name="l01130"></a>01130   {
<a name="l01131"></a>01131     cycleCtrl = <a class="code" href="group__DMA.html#ggf7c5bc2b557c15cabf48a19746df01b763be11c241248128c56500a9d7863029">dmaCycleCtrlBasic</a>;
<a name="l01132"></a>01132   }
<a name="l01133"></a>01133   <span class="keywordflow">else</span>
<a name="l01134"></a>01134   {
<a name="l01135"></a>01135     cycleCtrl = <a class="code" href="group__DMA.html#ggf7c5bc2b557c15cabf48a19746df01b7f4331d0c4073d4f24b329bb4b5f0a2fc">dmaCycleCtrlPingPong</a>;
<a name="l01136"></a>01136   }
<a name="l01137"></a>01137 
<a name="l01138"></a>01138   <span class="comment">/* Find descriptor to configure */</span>
<a name="l01139"></a>01139   <span class="keywordflow">if</span> (primary)
<a name="l01140"></a>01140   {
<a name="l01141"></a>01141     descr = ((DMA_DESCRIPTOR_TypeDef *)(DMA-&gt;CTRLBASE)) + channel;
<a name="l01142"></a>01142   }
<a name="l01143"></a>01143   <span class="keywordflow">else</span>
<a name="l01144"></a>01144   {
<a name="l01145"></a>01145     descr = ((DMA_DESCRIPTOR_TypeDef *)(DMA-&gt;ALTCTRLBASE)) + channel;
<a name="l01146"></a>01146   }
<a name="l01147"></a>01147 
<a name="l01148"></a>01148   <span class="keywordflow">if</span> (src)
<a name="l01149"></a>01149   {
<a name="l01150"></a>01150     inc = (descr-&gt;CTRL &amp; _DMA_CTRL_SRC_INC_MASK) &gt;&gt; _DMA_CTRL_SRC_INC_SHIFT;
<a name="l01151"></a>01151     <span class="keywordflow">if</span> (inc == _DMA_CTRL_SRC_INC_NONE)
<a name="l01152"></a>01152     {
<a name="l01153"></a>01153       descr-&gt;SRCEND = src;
<a name="l01154"></a>01154     }
<a name="l01155"></a>01155     <span class="keywordflow">else</span>
<a name="l01156"></a>01156     {
<a name="l01157"></a>01157       descr-&gt;SRCEND = (<span class="keywordtype">void</span> *)((uint32_t)src + (nMinus1 &lt;&lt; inc));
<a name="l01158"></a>01158     }
<a name="l01159"></a>01159   }
<a name="l01160"></a>01160 
<a name="l01161"></a>01161   <span class="keywordflow">if</span> (dst)
<a name="l01162"></a>01162   {
<a name="l01163"></a>01163     inc = (descr-&gt;CTRL &amp; _DMA_CTRL_DST_INC_MASK) &gt;&gt; _DMA_CTRL_DST_INC_SHIFT;
<a name="l01164"></a>01164     <span class="keywordflow">if</span> (inc == _DMA_CTRL_DST_INC_NONE)
<a name="l01165"></a>01165     {
<a name="l01166"></a>01166       descr-&gt;DSTEND = dst;
<a name="l01167"></a>01167     }
<a name="l01168"></a>01168     <span class="keywordflow">else</span>
<a name="l01169"></a>01169     {
<a name="l01170"></a>01170       descr-&gt;DSTEND = (<span class="keywordtype">void</span> *)((uint32_t)dst + (nMinus1 &lt;&lt; inc));
<a name="l01171"></a>01171     }
<a name="l01172"></a>01172   }
<a name="l01173"></a>01173 
<a name="l01174"></a>01174   chBit = 1 &lt;&lt; channel;
<a name="l01175"></a>01175   <span class="keywordflow">if</span> (useBurst)
<a name="l01176"></a>01176   {
<a name="l01177"></a>01177     DMA-&gt;CHUSEBURSTS = chBit;
<a name="l01178"></a>01178   }
<a name="l01179"></a>01179   <span class="keywordflow">else</span>
<a name="l01180"></a>01180   {
<a name="l01181"></a>01181     DMA-&gt;CHUSEBURSTC = chBit;
<a name="l01182"></a>01182   }
<a name="l01183"></a>01183 
<a name="l01184"></a>01184   <span class="comment">/* Set cycle control */</span>
<a name="l01185"></a>01185   tmp  = descr-&gt;CTRL &amp; ~(_DMA_CTRL_CYCLE_CTRL_MASK | _DMA_CTRL_N_MINUS_1_MASK);
<a name="l01186"></a>01186   tmp |= nMinus1 &lt;&lt; _DMA_CTRL_N_MINUS_1_SHIFT;
<a name="l01187"></a>01187   tmp |= cycleCtrl &lt;&lt; _DMA_CTRL_CYCLE_CTRL_SHIFT;
<a name="l01188"></a>01188   descr-&gt;CTRL = tmp;
<a name="l01189"></a>01189 }
<a name="l01190"></a>01190 
<a name="l01191"></a>01191 
<a name="l01192"></a>01192 <span class="comment">/***************************************************************************/</span>
<a name="l01203"></a><a class="code" href="group__DMA.html#g35a483de1c773d6cd958434372054b8b">01203</a> <span class="keywordtype">void</span> <a class="code" href="group__DMA.html#g35a483de1c773d6cd958434372054b8b">DMA_Reset</a>(<span class="keywordtype">void</span>)
<a name="l01204"></a>01204 {
<a name="l01205"></a>01205   <span class="keywordtype">int</span> i;
<a name="l01206"></a>01206 
<a name="l01207"></a>01207   <span class="comment">/* Disable DMA interrupts */</span>
<a name="l01208"></a>01208   NVIC_DisableIRQ(DMA_IRQn);
<a name="l01209"></a>01209 
<a name="l01210"></a>01210   <span class="comment">/* Put the DMA controller into a known state, first disabling it. */</span>
<a name="l01211"></a>01211   DMA-&gt;CONFIG      = _DMA_CONFIG_RESETVALUE;
<a name="l01212"></a>01212   DMA-&gt;CHUSEBURSTC = _DMA_CHUSEBURSTC_MASK;
<a name="l01213"></a>01213   DMA-&gt;CHREQMASKC  = _DMA_CHREQMASKC_MASK;
<a name="l01214"></a>01214   DMA-&gt;CHENC       = _DMA_CHENC_MASK;
<a name="l01215"></a>01215   DMA-&gt;CHALTC      = _DMA_CHALTC_MASK;
<a name="l01216"></a>01216   DMA-&gt;CHPRIC      = _DMA_CHPRIC_MASK;
<a name="l01217"></a>01217   DMA-&gt;ERRORC      = DMA_ERRORC_ERRORC;
<a name="l01218"></a>01218   DMA-&gt;IEN         = _DMA_IEN_RESETVALUE;
<a name="l01219"></a>01219   DMA-&gt;IFC         = _DMA_IFC_MASK;
<a name="l01220"></a>01220 
<a name="l01221"></a>01221   <span class="comment">/* Clear channel control flags */</span>
<a name="l01222"></a>01222   <span class="keywordflow">for</span> (i = 0; i &lt; DMA_CHAN_COUNT; i++)
<a name="l01223"></a>01223   {
<a name="l01224"></a>01224     DMA-&gt;CH[i].CTRL = _DMA_CH_CTRL_RESETVALUE;
<a name="l01225"></a>01225   }
<a name="l01226"></a>01226 }
<a name="l01227"></a>01227 
<a name="l01228"></a>01228 
<a name="l01231"></a>01231 <span class="preprocessor">#endif </span><span class="comment">/* defined( DMA_PRESENT ) */</span>
</pre></div><div id="footer">
<hr size="1"><address style="text-align: right;"><small>
Generated on Thu Sep 10 08:13:57 2015</small> for Silicon Labs EZR32 emlib Peripheral Library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a><small> 1.4.7 </small></address></div>
</body>
</html>
