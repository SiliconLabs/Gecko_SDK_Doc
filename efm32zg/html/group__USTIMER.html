<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>EFM32 Zero Gecko Software Documentation: USTIMER</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">EFM32 Zero Gecko Software Documentation
   &#160;<span id="projectnumber">efm32zg-doc-4.2.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="../../index.html"><span>Documentation&#160;Home</span></a></li>
      <li><a href="http://www.silabs.com"><span>silabs.com</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__USTIMER.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">USTIMER<div class="ingroups"><a class="el" href="group__EM__Drivers.html">EM_Drivers</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>USTIMER Microsecond delay timer module, see <a class="el" href="group__USTIMER.html">USTIMER Microsecond delay timer module</a> page for detailed documentation. </p><pre class="fragment"></pre><p>.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gafa7a3cfd6fa84e52ff30b19963c550bc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gafa7a3cfd6fa84e52ff30b19963c550bc"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__USTIMER.html#gafa7a3cfd6fa84e52ff30b19963c550bc">ECODE_EMDRV_USTIMER_OK</a>&#160;&#160;&#160;( <a class="el" href="group__EM__Drivers.html#gad59417e7951d81dfc15ec2757f08148e">ECODE_OK</a> )</td></tr>
<tr class="memdesc:gafa7a3cfd6fa84e52ff30b19963c550bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Success return value. <br /></td></tr>
<tr class="separator:gafa7a3cfd6fa84e52ff30b19963c550bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga5c7fa9c799b61638907d4f832a45e58b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__EM__Drivers.html#ga7bf5621660c5ba69ac4dd3044173d35c">Ecode_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__USTIMER.html#ga5c7fa9c799b61638907d4f832a45e58b">USTIMER_Init</a> (void)</td></tr>
<tr class="memdesc:ga5c7fa9c799b61638907d4f832a45e58b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Activate and initialize the hardware timer used to pace the 1 microsecond delay functions.  <a href="#ga5c7fa9c799b61638907d4f832a45e58b">More...</a><br /></td></tr>
<tr class="separator:ga5c7fa9c799b61638907d4f832a45e58b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae0ab9e930ee6cbd71061142c4ad4e298"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__EM__Drivers.html#ga7bf5621660c5ba69ac4dd3044173d35c">Ecode_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__USTIMER.html#gae0ab9e930ee6cbd71061142c4ad4e298">USTIMER_DeInit</a> (void)</td></tr>
<tr class="memdesc:gae0ab9e930ee6cbd71061142c4ad4e298"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deinitialize USTIMER driver.  <a href="#gae0ab9e930ee6cbd71061142c4ad4e298">More...</a><br /></td></tr>
<tr class="separator:gae0ab9e930ee6cbd71061142c4ad4e298"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3a844fc16a527d15450ba4692f6ce047"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__EM__Drivers.html#ga7bf5621660c5ba69ac4dd3044173d35c">Ecode_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__USTIMER.html#ga3a844fc16a527d15450ba4692f6ce047">USTIMER_Delay</a> (uint32_t usec)</td></tr>
<tr class="memdesc:ga3a844fc16a527d15450ba4692f6ce047"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delay a given number of microseconds.  <a href="#ga3a844fc16a527d15450ba4692f6ce047">More...</a><br /></td></tr>
<tr class="separator:ga3a844fc16a527d15450ba4692f6ce047"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga22982b2c10f35aa2f9dacb7252dfa0af"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__EM__Drivers.html#ga7bf5621660c5ba69ac4dd3044173d35c">Ecode_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__USTIMER.html#ga22982b2c10f35aa2f9dacb7252dfa0af">USTIMER_DelayIntSafe</a> (uint32_t usec)</td></tr>
<tr class="memdesc:ga22982b2c10f35aa2f9dacb7252dfa0af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delay a given number of microseconds.  <a href="#ga22982b2c10f35aa2f9dacb7252dfa0af">More...</a><br /></td></tr>
<tr class="separator:ga22982b2c10f35aa2f9dacb7252dfa0af"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>


<h3><a class="anchor" id="ustimer_doc"></a>USTIMER Microsecond delay timer module</h3><div class="textblock">Implements microsecond delays.The delay is implemented using a hardware timer. <a class="el" href="group__USTIMER.html#ga5c7fa9c799b61638907d4f832a45e58b">USTIMER_Init()</a> must be called prior to using the delay functions. <a class="el" href="group__USTIMER.html#ga5c7fa9c799b61638907d4f832a45e58b">USTIMER_Init()</a> must also be called if HFCORECLK and/or HFPERCLK is changed.The source files for the USTIMER driver library resides in the emdrv/ustimer folder, and are named <a class="el" href="ustimer_8c.html" title="Microsecond delay functions. ">ustimer.c</a> and <a class="el" href="ustimer_8h.html" title="Microsecond delay function API definition. ">ustimer.h</a>.<ul>
<li><a class="el" href="group__USTIMER.html#ustimer_intro">Introduction</a> </li>
<li><a class="el" href="group__USTIMER.html#ustimer_conf">Configuration Options</a> </li>
<li><a class="el" href="group__USTIMER.html#ustimer_api">The API</a> </li>
<li><a class="el" href="group__USTIMER.html#ustimer_example">Example</a></li>
</ul>
<p><br />
 <h1><a class="anchor" id="ustimer_intro"></a>
Introduction</h1>
<p>The USTIMER driver implements microsecond delay functions. The delay is timed using a hardware TIMER resource. Two delay functions are available, one which use energy mode EM1 to preserve energy while waiting, and one which performs busy wait.</p>
<p><br />
 </p>
<h1><a class="anchor" id="ustimer_conf"></a>
Configuration Options</h1>
<p>By default the module use TIMER0. Timer resource selection is stored in a file named ustimer_config.h. A template for this file, containing default value, resides in the emdrv/config folder.</p>
<p>To configure USTIMER, provide your own configuration file. Here is a sample ustimer_config.h file: </p><pre class="fragment">#ifndef __SILICON_LABS_USTIMER_CONFIG_H__
#define __SILICON_LABS_USTIMER_CONFIG_H__

/// USTIMER configuration option. Use this define to select a TIMER resource.
#define USTIMER_TIMER USTIMER_TIMER3

#endif</pre><p><br />
 </p>
<h1><a class="anchor" id="ustimer_api"></a>
The API</h1>
<p>This section contain brief descriptions of the functions in the API. You will find detailed information on input and output parameters and return values by clicking on the hyperlinked function names. Most functions return an error code, <a class="el" href="group__USTIMER.html#gafa7a3cfd6fa84e52ff30b19963c550bc">ECODE_EMDRV_USTIMER_OK</a> is returned on success, see <a class="el" href="ecode_8h.html">ecode.h</a> and <a class="el" href="ustimer_8h.html">ustimer.h</a> for other error codes.</p>
<p>Your application code must include one header file: <em><a class="el" href="ustimer_8h.html" title="Microsecond delay function API definition. ">ustimer.h</a></em>.</p>
<p><a class="el" href="group__USTIMER.html#ga5c7fa9c799b61638907d4f832a45e58b">USTIMER_Init()</a>, <a class="el" href="group__USTIMER.html#gae0ab9e930ee6cbd71061142c4ad4e298">USTIMER_DeInit()</a> <br />
 These functions initializes or deinitializes the USTIMER driver. Typically  USTIMER_Init()  is called once in your startup code.</p>
<p><a class="el" href="group__USTIMER.html#ga3a844fc16a527d15450ba4692f6ce047">USTIMER_Delay()</a> Delay a given number of microseconds. The mcu is put in EM1 during the delay.</p>
<p><a class="el" href="group__USTIMER.html#ga22982b2c10f35aa2f9dacb7252dfa0af">USTIMER_DelayIntSafe()</a> Delay a given number of microseconds. The mcu is not put in EM1 during the delay. This function can be called in any context and is also thread safe.</p>
<p><br />
 </p>
<h1><a class="anchor" id="ustimer_example"></a>
Example</h1>
<pre class="fragment">#include "ustimer.h"

int main( void )
{
  // Initialization of USTIMER driver
  USTIMER_Init();

  // Wait for 250 microseconds
  USTIMER_Delay( 250 );
}</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga5c7fa9c799b61638907d4f832a45e58b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__EM__Drivers.html#ga7bf5621660c5ba69ac4dd3044173d35c">Ecode_t</a> USTIMER_Init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section note"><dt>Note</dt><dd>Call this function whenever the HFPERCLK and/or HFCORECLK frequency is changed.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group__USTIMER.html#gafa7a3cfd6fa84e52ff30b19963c550bc">ECODE_EMDRV_USTIMER_OK</a>. </dd></dl>

<p>Definition at line <a class="el" href="ustimer_8c_source.html#l00086">86</a> of file <a class="el" href="ustimer_8c_source.html">ustimer.c</a>.</p>

<p>References <a class="el" href="efm32zg__timer_8h_source.html#l00150">_TIMER_CTRL_PRESC_DIV1</a>, <a class="el" href="efm32zg__timer_8h_source.html#l00160">_TIMER_CTRL_PRESC_DIV1024</a>, <a class="el" href="em__cmu_8c_source.html#l01369">CMU_ClockEnable()</a>, <a class="el" href="em__cmu_8c_source.html#l01482">CMU_ClockFreqGet()</a>, <a class="el" href="em__cmu_8h_source.html#l00629">cmuClock_CORE</a>, <a class="el" href="em__cmu_8h_source.html#l00382">cmuClock_HFPER</a>, <a class="el" href="ustimer_8h_source.html#l00038">ECODE_EMDRV_USTIMER_OK</a>, <a class="el" href="em__timer_8h_source.html#l00375">TIMER_InitCC_TypeDef::mode</a>, <a class="el" href="em__timer_8h_source.html#l00279">TIMER_Init_TypeDef::prescale</a>, <a class="el" href="efm32zg__timer_8h_source.html#l00291">TIMER_IEN_CC0</a>, <a class="el" href="em__timer_8c_source.html#l00076">TIMER_Init()</a>, <a class="el" href="em__timer_8h_source.html#l00317">TIMER_INIT_DEFAULT</a>, <a class="el" href="em__timer_8c_source.html#l00130">TIMER_InitCC()</a>, <a class="el" href="em__timer_8h_source.html#l00397">TIMER_INITCC_DEFAULT</a>, <a class="el" href="em__timer_8h_source.html#l00730">TIMER_IntDisable()</a>, <a class="el" href="em__timer_8h_source.html#l00900">TIMER_TopSet()</a>, and <a class="el" href="em__timer_8h_source.html#l00101">timerCCModeCompare</a>.</p>

<p>Referenced by <a class="el" href="ezradio__api__lib_8c_source.html#l00054">ezradio_reset()</a>.</p>

</div>
</div>
<a class="anchor" id="gae0ab9e930ee6cbd71061142c4ad4e298"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__EM__Drivers.html#ga7bf5621660c5ba69ac4dd3044173d35c">Ecode_t</a> USTIMER_DeInit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Will disable interrupts and turn off the clock to the underlying hardware timer.</p>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group__USTIMER.html#gafa7a3cfd6fa84e52ff30b19963c550bc">ECODE_EMDRV_USTIMER_OK</a>. </dd></dl>

<p>Definition at line <a class="el" href="ustimer_8c_source.html#l00137">137</a> of file <a class="el" href="ustimer_8c_source.html">ustimer.c</a>.</p>

<p>References <a class="el" href="em__cmu_8c_source.html#l01369">CMU_ClockEnable()</a>, <a class="el" href="ustimer_8h_source.html#l00038">ECODE_EMDRV_USTIMER_OK</a>, <a class="el" href="em__timer_8h_source.html#l00613">TIMER_Enable()</a>, <a class="el" href="efm32zg__timer_8h_source.html#l00291">TIMER_IEN_CC0</a>, <a class="el" href="efm32zg__timer_8h_source.html#l00423">TIMER_IFC_CC0</a>, <a class="el" href="em__timer_8h_source.html#l00713">TIMER_IntClear()</a>, and <a class="el" href="em__timer_8h_source.html#l00730">TIMER_IntDisable()</a>.</p>

<p>Referenced by <a class="el" href="ezradio__api__lib_8c_source.html#l00054">ezradio_reset()</a>.</p>

</div>
</div>
<a class="anchor" id="ga3a844fc16a527d15450ba4692f6ce047"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__EM__Drivers.html#ga7bf5621660c5ba69ac4dd3044173d35c">Ecode_t</a> USTIMER_Delay </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>usec</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The mcu is put in EM1 during the delay.</p>
<dl class="section note"><dt>Note</dt><dd>This function assumes that the timer interrupt needed to wake the mcu up from EM1 is not blocked. This function is not thread safe.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">usec</td><td>Number of microseconds to delay.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group__USTIMER.html#gafa7a3cfd6fa84e52ff30b19963c550bc">ECODE_EMDRV_USTIMER_OK</a>. </dd></dl>

<p>Definition at line <a class="el" href="ustimer_8c_source.html#l00168">168</a> of file <a class="el" href="ustimer_8c_source.html">ustimer.c</a>.</p>

<p>References <a class="el" href="ustimer_8h_source.html#l00038">ECODE_EMDRV_USTIMER_OK</a>.</p>

<p>Referenced by <a class="el" href="ezradio__api__lib_8c_source.html#l00054">ezradio_reset()</a>.</p>

</div>
</div>
<a class="anchor" id="ga22982b2c10f35aa2f9dacb7252dfa0af"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__EM__Drivers.html#ga7bf5621660c5ba69ac4dd3044173d35c">Ecode_t</a> USTIMER_DelayIntSafe </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>usec</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is a busy wait delay not using energy modes to conserve power.</p>
<dl class="section note"><dt>Note</dt><dd>This function can be used in any context (interrupts can be disabled). This function is thread safe.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">usec</td><td>Number of microseconds to delay.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group__USTIMER.html#gafa7a3cfd6fa84e52ff30b19963c550bc">ECODE_EMDRV_USTIMER_OK</a>. </dd></dl>

<p>Definition at line <a class="el" href="ustimer_8c_source.html#l00203">203</a> of file <a class="el" href="ustimer_8c_source.html">ustimer.c</a>.</p>

<p>References <a class="el" href="ustimer_8h_source.html#l00038">ECODE_EMDRV_USTIMER_OK</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Dec 8 2015 15:38:49 for EFM32 Zero Gecko Software Documentation by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
